\chapter{Own proofs}
\begin{lemma}\label{lemma-f_2n=frac}
  \Lrws, then
 \[
 f_{2n}=\frac{1}{2n-1}u_{2n}
 \]
\end{lemma}
\begin{proof}
 \[
  \begin{split}
    u_{2n-2} & =2^{-(2n-2)}\binom{2n-2}{n-1}=4\cdot 2^{-2n} \frac{ \left( 2n-2 \right) !}{ \left( n-1 \right) ! \left( n-1 \right) !}\\
    & =\frac{4n^2}{ \left( 2n \right) \left( 2n-1 \right) }2^{-2n}\binom{2n}{n}
    =\frac{2n}{2n-1}u_{2n}.
  \end{split}
 \]
 Therefore,
 \[
 f_{2n} \overset{\text{L}\ref{thm-f_2n}}{=} u_{2n-2}-u_{2n}=u_{2n} \left( \frac{2n}{2n-1}-1 \right)
 =u_{2n}\frac{1}{2n-1}.
 \]
\end{proof}

\begin{lemma}[Decomposition of $f_n$]\label{lemma-decomposition_f_n}
  \Lrws.
  \[
  \pr\left(S_{2n}=0\right)=\suma[r][1][n] f_{2r}u_{2n-2r}
  \]
\end{lemma}

\begin{proof}
  \[
    \begin{split}
      & \pr \left(S_{2n}=0\right)
      \ltp \suma[r][1][n] \pr \left(S_{2n}=0,S_1, S_2, \ldots, S_{2r-1}\neq 0, S_{2r}=0\right)\\
      & \gpr \suma[r][1][n] \pr \left(S_{2n}=0 \Mid S_1, S_2, \ldots, S_{2r-1}\neq 0 S_{2r}=0\right)\cdot\\
      &\pr \left(S_1, S_2, \ldots, S_{2r-1}\neq 0, S_{2r}=0\right)\\
      & \overset{\text{L}\ref{lemma-markov_property} \text{,D}\ref{defn-return_origin}}{=}\suma[r][1][n] \pr \left(S_{2n}=0 \Mid S_{2r}=0\right) f_{2r}
      \overset{\text{L}\ref{lemma-temporal_homogeneity}}{=}\suma[r][1][n]
      \pr \left(S_{2n-2r}=0\right) f_{2r}\overset{\text{D}\ref{defn-return_origin}}{=}
      \suma[r][1][n] u_{2n-2r}f_{2r}.
    \end{split}
  \]
\end{proof}
\begin{thm}[Arcsine law for last visits]\label{thm-arcsine_last_visits}
 \Lrws\ $k,n \in \N, k\leq n$.
 The probability that up to \Time $2n$ the last return to origin occurred \intime $2k$ is given by
\[
\pr\left( S_{2k}=0\right)\pr\left( S_{2n-2k}=0\right).
\]
\end{thm}
\begin{proof}
 The probability involved can be rewritten as:
 \[
  \begin{split}
    & \pr \left(S_{2k}=0, S_{2k+1}, S_{2k+2}, \ldots, S_{2n} \neq 0\right)\\
    & \gpr \pr \left( S_{2k+1}, S_{2k+2}, \ldots, S_{2n}\neq 0\mid S_{2k}=0 \right) \pr \left( S_{2k}=0 \right)\\
    & \overset{\text{L}\ref{lemma-temporal_homogeneity}}{=}\pr \left( S_{1}, S_{2}, \ldots, S_{2n-2k}\neq 0 \right) \pr \left( S_{2k}=0 \right)
    \overset{\text{T}\ref{thm-no_return=return}}{=}u_{2n-2k}u_{2k}
  \end{split}
\]
\end{proof}
\begin{defn}[Time spend on the positive and negative sides]\label{defn-time_spent_positive_side}

 \Lrw. We say that \emph{the walk spent $\tau$ time units of $n$ on the positive side} if $\suma \indikator{S_i>0 \lor S_{i-1}>0}=\tau.$
 Let $T_n$ denote $\suma \indikator{S_i>0 \lor S_{i-1}>0}$ and $\beta_{n} \left( \tau \right)$ denote $\pr\left(T_n=\tau \right)$.
 Similarly, we say that \emph{the walk spent $\zeta$ time units of $n$ on the negative side} if
 $\suma\indikator{S_i<0 \lor S_{i-1}<0}=\zeta.$
\end{defn}


\begin{thm}[Arcsine law for sojourn times-OWN PROOF]\label{thm-arcsine_sojourn_times}
 \Lrws. Then
 \[
 \beta_{2n} \left( 2k \right) =\alpha_{2n} \left( 2k \right)=\pr\left( S_{2n}=0\right)\pr\left( S_{2n-2k}=0\right).
 \]
\end{thm}
\begin{proof}%My own proof
 First let us start with degenerate cases.
 \[
    \beta_{2n} \left( 2n \right)
    =\pr \left( T_{2n}=2n \right)
    \overset{\text{L}\ref{lemma-probability_above_or_on}}{=}\pr \left( S_1, S_2, \ldots, S_{2n}\geq 0 \right) =u_{2n}.
 \]
 By symmetry $\beta_{2n} \left( 0 \right) =\beta_{2n} \left( 2n \right).$

 Let us fix $v \leq n$ and let $1 \leq k \leq v-1$, then the following equation holds:
 \[
  \begin{split}
    & \beta_{2n} \left( 2k \right) \overset{\text{D}\ref{defn-time_spent_positive_side}}{=} \pr \left( T_{2n}=2k \right)
     \ltp \suma[r][1][n]\pr \left( T_{2n}=2k, S_1, S_2, \ldots, S_{2r-1}\neq 0, S_{2r}=0 \right)\\
    & = \suma[r][1][n]\pr \left( T_{2n}=2k, S_1, S_2, \ldots, S_{2r-1}< 0, S_{2r}=0 \right)\\
    & +\suma[r][1][n]\pr \left( T_{2n}=2k, S_1, S_2, \ldots, S_{2r-1}> 0, S_{2r}=0 \right)\\
    & \gpr \suma[r][1][n]\pr \left( T_{2n}=2k \Mid S_1, S_2, \ldots, S_{2r-1}< 0, S_{2r}=0 \right) \cdot \\
    & \pr \left( S_1, S_2, \ldots, S_{2r-1}< 0, S_{2r}=0 \right)\\
    & +\suma[r][1][n]\pr \left( T_{2n}=2k \Mid S_1, S_2, \ldots, S_{2r-1}> 0, S_{2r}=0 \right) \cdot \\
    & \pr \left( S_1, S_2, \ldots, S_{2r-1}>0, S_{2r}=0 \right)\\
    & \overset{\text{L}\ref{lemma-markov_property}}{=} \suma[r][1][n]\pr \left( T_{2n}=2k \Mid S_{2r}=0 \right)
    \pr \left( S_1, S_2, \ldots, S_{2r-1}< 0, S_{2r}=0 \right)\\
    & +\suma[r][1][n]\pr \left( T_{2n}=2k \Mid S_{2r}=0 \right)
    \pr \left( S_1, S_2, \ldots, S_{2r-1}>0, S_{2r}=0 \right)\\
    & \overset{*}{=} \suma[r][1][n] \h f_{2r} \pr \left( T_{2n}-T_{2r}=2k \Mid S_{2r}=0 \right)\\
    & + \suma[r][1][n] \h f_{2r} \pr \left( T_{2n}-T_{2r}=2k-2r \Mid S_{2r}=0 \right)\\
    &\overset{\text{L}\ref{lemma-temporal_homogeneity}}{=} \suma[r][1][n] \h f_{2r} \pr \left( T_{2n-2r}=2k\right)
    + \suma[r][1][n] \h f_{2r} \pr \left( T_{2n-2r}=2k-2r\right)\\
    &=\suma[r][1][n] \h f_{2r} \beta_{2n-2r}\left(2k \right) +\suma[r][1][n] \h f_{2r}\beta_{2n-2r}\left(2k-2r\right).
  \end{split}
 \]
 The third equation comes from the disjoint decomposition of
 \[
 [S_1, S_2, \ldots, S_{2r-1}\neq 0]=[S_1, S_2, \ldots, S_{2r-1}> 0]\cup[S_1, S_2, \ldots, S_{2r-1}<0]
 \]
  and the equation marked $*$ comes from using the condition that up to time $2r$ the steps were on the positive/negative sides.

 Now let us proceed by induction. Case for $v=1$ is trivial because it implies the degenerate case. Let the statement be true for all $v \leq n-1$, then
 \[
  \begin{split}
    &\beta_{2n}\left(2k\right)=\suma[r][1][n] \h f_{2r} \beta_{2n-2r}\left(2k\right)+\suma[r][1][n] \h f_{2r}\beta_{2n-2r}\left(2k-2r\right)\\
    & \induk \suma[r][1][n] \h f_{2r} \alpha_{2n-2r}\left(2k\right)+\suma[r][1][n] \h f_{2r}\alpha_{2n-2r}\left(2k-2r\right)\\
    & \overset{\text{D}\ref{defn-return_origin}}{=} \suma[r][1][n] \h f_{2r} u_{2k}u_{2n-2r-2k}+\suma[r][1][n] \h f_{2r} u_{2k-2r}u_{2n-2k}\\
    & = \h u_{2k} \suma[r][1][n] f_{2r} u_{2n-2r-2k}+ \h u_{2n-2k} \suma[r][1][n] f_{2r} u_{2k-2r}\\
    & \overset{\text{L}\ref{lemma-decomposition_f_n}}{=} \h u_{2n-2k} u_{2k} +\h u_{2n-2k} u_{2k}=u_{2n-2k} u_{2k}
   \overset{\text{D}\ref{defn-return_origin}}{=}\alpha_{2n}\left(2k\right).
  \end{split}
 \]
\end{proof}
\begin{comment}
\begin{defn}[Change of a sign]
 \Lrw. We say that \intime $n$ occurred a change of sign if if $S_{n-1}\cdot S_{n+1}=-1$ in other words if $\left(S_{n-1}=+1 \land S_{n+1}=-1\right) \lor \left(S_{n-1}=-1 \land S_{n+1}=+1\right).$
 We shall denote the probability that up to \Time $n$ occurred $r$ changes of sign by $\xi_{r, n}$.
\end{defn}
\begin{thm}[Change of a sign]
 \Lrws. The probability $\xi_{r,2n+1}=2\pr\left( S_{2n+1}=2r+1 \right)$
\end{thm}
\begin{proof}
 Feller
\end{proof}
\end{comment}
\begin{defn}[Time spent above $a$]
  \Lrw. We say that \emph{the walk spent $z$ time units up to time $n$ in the interval $\left[a,\pinf \right)$} if $\suma \indikator{S_i>a \lor S_{i-1}>a}=z.$
  Let $T_n\left(a\right)$ denote $\suma \indikator{S_i>a \lor S_{i-1}>a}.$
\end{defn}
\begin{thm}[Probability questioned \todo]
  \Lrws, let $a>0.$ Then
  \[
  \pr \left(T_{2n} \left( 2a \right) = 2z \right)=
  \]
\end{thm}
\begin{proof}
  \[
    \begin{split}
      &\pr \left(T_{2n}\left(2a\right)=2z\right)\\
      &\gpr \suma \left(T_{2n}\left(2a\right)=2z \Mid S_1,S_2, \ldots, S_{2i-1}<2a, S_{2i}=2a\right)\pr\left(S_1,S_2, \ldots, S_{2i-1}<2a, S_{2i}=2a\right)\\
      &\overset{\text{D}\ref{defn-new_maximum}}{=}\suma \left(T_{2n}\left(2a\right)=2z \Mid S_1,S_2, \ldots, S_{2i-1}<2a, S_{2i}=2a\right)\cdot f_{2a}\left(2k\right).
    \end{split}
  \]
  Now let us look at $\left(T_{2n}\left(2a\right)=2z \Mid S_1,S_2, \ldots, S_{2i-1}<2a, S_{2i}=2a\right).$
  It is also true that
  $T_{2n}\left(2a\right)=T_{2n-2i}\left(2a\right)+T_{2i}\left(2a\right),$
  but given the condition $S_1,S_2, \ldots, S_{2i-1}<2a, S_{2i}=2a$
  we now that $T_{2i}\left(2a\right)=0$ therefore,
  \[
    \begin{split}
        & \left(T_{2n-2i}\left(2a\right)=2z \Mid S_1,S_2, \ldots, S_{2i-1}<2a, S_{2i}=2a\right)
        \overset{\text{L}\ref{lemma-markov_property}}{=} \left(T_{2n-2i}\left(2a\right)=2z \Mid S_{2i}=2a\right)\\
        & \overset{\text{L}\ref{lemma-spatial_homogeneity}}{=} \left(T_{2n-2i}=2z \Mid S_{2i}=0\right)
    \end{split}
  \]
  \[
  \left(T_{2n}\left(2a\right)=2z \Mid S_1,S_2, \ldots, S_{2i-1}<2a, S_{2i}=2a\right)
  \]
\end{proof}

\section{Problem chapter 9 Feller-není dokončeno, zkontrolováno ani upraveno do čitelnější podoby}
\begin{defn}[$\delta_n, \varepsilon_n^{r,\pm}$]\label{defn-delta_epsilon}
 \Lrws.
 \[
    \begin{split}
      & \delta_{n}\left( k\right) \text{shall denote} \pr\left(\suma \indikator{S_i>0 \lor S_{i-1}>0}=k, S_n=0 \right),\\
      & \varepsilon_{n}^r\left(k \right) \text{shall denote} \pr\left(\suma \indikator{S_i>0 \lor S_{i-1}>0}=k, S_1, S_2, \ldots, S_{r-1}\neq 0, S_r=0, S_n=0 \right),\\
      & \varepsilon_{n}^{r,+}\left(k \right) \text{shall denote} \pr\left(\suma \indikator{S_i>0 \lor S_{i-1}>0}=k, S_1, S_2, \ldots, S_{r-1} > 0, S_r=0, S_n=0 \right),\\
      & \varepsilon_{n}^{r,-}\left(k \right) \text{shall denote} \pr\left(\suma \indikator{S_i>0 \lor S_{i-1}>0}=k, S_1, S_2, \ldots, S_{r-1} < 0, S_r=0, S_n=0 \right).
    \end{split}
 \]
\end{defn}
\begin{lemma}[Factorization of $\delta_{2n}\left( 2k\right)$]\label{lemma-factorization_lemma}
 $\delta_{2n}\left( 2k\right)
 =\h \suma[r][1][n]\left( f_{2r} \delta_{2n-2r}\left(2k-2r\right)+f_{2r} \delta_{2n-2r}\left( 2r \right)\right)$.
\end{lemma}
\begin{proof}
 Because $S_{2n}=0$ a return to origin must have happened. Let $2r$ the \Time of first return to origin, where $r \in \{1, 2, \ldots, n\}$. By the law of total probability:
 $\delta_{2n}\left( 2k\right)
 \overset{\text{D}\ref{defn-delta_epsilon}}{=}\pr\left(\suma[i][1][2n] \indikator{S_i>0 \lor S_{i-1}>0}=k, S_{2n}=0 \right)\\
 \ltp \suma[r][1][n]\pr\left(\suma[i][1][2n] \indikator{S_i>0 \lor S_{i-1}>0}=2k, S_1, S_2, \ldots, S_{2r-1}\neq 0, S_{2r}=0, S_{2n}=0 \right)\\
 \overset{\text{D}\ref{defn-delta_epsilon}}{=}\suma[r][1][n] \varepsilon_{2n}^{2k}
 \overset{*}{=} \suma[r][1][n]\pr\left(\suma[i][1][2n] \indikator{S_i>0 \lor S_{i-1}>0}=2k, S_1, S_2, \ldots, S_{2r-1}> 0, S_{2r}=0, S_{2n}=0 \right)\\
 +\suma[r][1][n]\pr\left(\suma[i][1][2n] \indikator{S_i>0 \lor S_{i-1}>0}=2k, S_1, S_2, \ldots, S_{2r-1}< 0, S_{2r}=0, S_{2n}=0\right)\\
 =\suma[r][1][n]\varepsilon_{2n}^{2r,+}\left(2k\right)+\suma[r][1][n]\varepsilon_{2n}^{2r,-}\left(2k\right).$

 Where $*$ comes from the disjoint decomposition $[S_1, S_2, \ldots, S_{2r-1} \neq 0]=[S_1, S_2, \ldots, S_{2r-1} > 0]\cup [S_1, S_2, \ldots, S_{2r-1} < 0]$.

 Now let us calculate
 $\varepsilon_{2n}^{2r,+}\left(2k\right)\\
 =\pr\left(\suma[i][1][2n] \indikator{S_i>0 \lor S_{i-1}>0}=2k, S_1, S_2, \ldots, S_{2r-1}> 0, S_{2r}=0, S_{2n}=0 \right)\\
 \gpr \pr\left(\suma[i][1][2n] \indikator{S_i>0 \lor S_{i-1}>0}=2k, S_{2n}=0 \mid S_1, S_2, \ldots, S_{2r-1}> 0, S_{2r}=0 \right)\\
 \pr \left( S_1, S_2, \ldots, S_{2r-1}> 0, S_{2r}=0 \right)\\
 \overset{*}{=} \pr\left(T_{2n}-T_{2r}=2k-2r, S_{2n}=0 \Mid S_{2r}=0 \right)
 \pr \left( S_1, S_2, \ldots, S_{2r-1}> 0, S_{2r}=0 \right)\\
 \overset{**}{=}\pr\left(T_{2n}-T_{2r}=2k-2r, S_{2n}=0 \Mid S_{2r}=0 \right) \h f_2r\\
  \overset{\text{L}\ref{lemma-temporal_homogeneity}}{=} \pr\left(T_{2n-2r}=2k-2r, S_{2n-2r}=0\right) \h f_{2r}\\
 \overset{\text{D}\ref{defn-delta_epsilon}}{=}\delta_{2n-2r} \left( 2k-2r \right)\h f_{2r}.$

 Where $*$ comes from Lemma (\ref{lemma-markov_property}) and using the condition.

 Where $**$ comes from the fact that $f_{2r}\overset{\text{D}\ref{defn-return_origin}}{=}\pr \left(S_1, S_2, \ldots, S_{2r-1}\neq 0, S_{2r}=0\right)=\pr \left(S_1=1, S_2, \ldots, S_{2r-1}> 0, S_{2r}=0\right)+\pr \left(S_1=-1, S_2, \ldots, S_{2r-1}< 0, S_{2r}=0\right)$ and $\pr \left(S_1=-1, S_2, \ldots, S_{2r-1}< 0, S_{2r}=0\right)=\pr \left(S_1=1, S_2, \ldots, S_{2r-1}> 0, S_{2r}=0\right)$ because of symmetry. Hence $\pr \left(S_1=1, S_2, \ldots, S_{2r-1}> 0, S_{2r}=0\right)=\h f_{2r}.$

 Similarly $\varepsilon_{2n}^{2r,+}\left(2k\right)\\
 =\pr\left(\suma[i][1][2n] \indikator{S_i>0 \lor S_{i-1}>0}=2k, S_1, S_2, \ldots, S_{2r-1}< 0, S_{2r}=0, S_{2n}=0 \right)\\
 = \pr\left(\suma[i][1][2n] \indikator{S_i>0 \lor S_{i-1}>0}=2k, S_{2n}=0 \mid S_1, S_2, \ldots, S_{2r-1}< 0, S_{2r}=0 \right)\\
 \pr \left( S_1, S_2, \ldots, S_{2r-1}< 0, S_{2r}=0 \right)\\
 = \pr\left(T_{2n}-T_{2r}=2k, S_{2n}=0 \Mid S_{2r}=0 \right)
 \pr \left( S_1, S_2, \ldots, S_{2r-1}< 0, S_{2r}=0 \right)\\
 =\pr\left(T_{2n}-T_{2r}=2k, S_{2n}=0 \Mid S_{2r}=0 \right) \h f_2r\\
 =\pr\left(T_{2n-2r}=2k, S_{2n-2r}=0\right) \h f_{2r}\\
 =\delta_{2n-2r} \left( 2k\right)\h f_{2r}.$

 Therefore $\delta_{2n} \left(2k \right)
 =\frac{1}{2}\suma[r][1][n] f_{2r}\delta_{2n-2r} \left( 2k-2r\right)+\frac{1}{2}\suma[r][1][n] f_{2r}\delta_{2n-2r} \left( 2k \right)\\
 =\h \suma[r][1][n]\left( f_{2r} \delta_{2n-2r}\left(2k-2r\right)+f_{2r} \delta_{2n-2r}\left( 2r \right)\right)$
\end{proof}

\begin{thm}[Equidistributional theorem-ALMOST COMPLETE OWN PROOF]
 \Lrws\ and $n \in \N$, then
 $\forall k,l \in \{0, 1, 2, \ldots, n \}:\delta_{2n}\left( 2k \right)=\delta_{2n}\left( 2l \right)=\frac{u_{2n}}{n+1}.$
\end{thm}
\begin{proof}
 Let us prove this statement by induction in $n$. In case that $n=1$ we have two options for $k$. Either $k=0$ or $k=1$.
 $\delta_2 \left(0 \right)
 =\pr\left( S_1=-1, S_2=0\right)
 =\h u_{2}
 =\pr\left( S_1=+1, S_2=0\right)
 =\delta_2 \left(2 \right).$

 Let the statement be true for all $l\leq n-1$. In that case $\delta_{2(n-l)}\left( 2k \right)=\frac{u_{2(n-l)}}{n-l+1} \forall k \in \{1,2,\ldots, n-l\}$.
 We want to show that $\delta_{2n}=\frac{u_{2n}}{n+1}$.

 Let us calculate $\delta_{2n}
 \overset{\text{L}\ref{lemma-factorization_lemma}}{=}\h \suma[r][1][n]\left( f_{2r} \delta_{2n-2r}\left(2k-2r\right)+f_{2r} \delta_{2n-2r}\left( 2r \right)\right)\\
 \induk \h \suma[r][1][n]\left( f_{2r} u_{2n-2r}\frac{1}{n-r+1}+f_{2r}u_{2n-2r}\frac{1}{n-r+1}\right)
 =\suma[r][1][n]\frac{f_{2r} u_{2n-2r}}{n-r+1}
 \overset{\text{SNAD TO DOKAZU }\text{L}\ref{lemma-binomial_sum}}{=}\frac{u_{2n}}{n+1}$

\end{proof}
\begin{lemma}[Sum of binomials-POTŘEBUJU DOKÁZAT]\label{lemma-binomial_sum}
  $\suma[r][1][n]\frac{f_{2r} u_{2n-2r}}{n-r+1}=\frac{u_{2n}}{n+1}$
\end{lemma}
\begin{proof}
  $f_{2r} u_{2n-2r}
  \overset{\text{L}\ref{lemma-f_2n=frac}}{=}\frac{1}{2r-1}u_{2r}u_{2n-2r}
  \overset{\text{D}\ref{defn-return_origin}}{=}\frac{1}{2r-1}2^{-2r}\binom{2r}{r}2^{-\left(2n-2r\right)}\binom{2n-2r}{n-r}.$

  Therefore
  $\suma[r][1][n]\frac{f_{2r} u_{2n-2r}}{n-r+1}=\suma[r][1][n]\frac{1}{2r-1}\frac{1}{n-r+1}2^{-2n}\binom{2r}{r}\binom{2n-2r}{n-r}\overset{???}{=}\frac{1}{n+1}2^{-2n}\binom{2n}{n}$
\end{proof}
